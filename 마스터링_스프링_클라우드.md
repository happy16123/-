## 마이크로서비스?
- IT 시스템 아키텍처 접근 방식 중 하나
- 비즈니스 요구사항을 구현한 하나의 애플리케이션을 느슨하게 연결된 여러 애플리케이션으로 쪼개는 것
- 서비스 기반 아키텍처(SOA) 개념의 다른 형태
- 가장 중요한 혜택 중 하나는 대규모의 복잡한 애플리케이션을 지속해서 배포하는 능력
- 확장성, 유연성, 독립적 배포성과 같은 장점이 있음

## 클라우드 네이티브
"클라우드 네이티브는 클라우드 컴퓨팅 모델의 장점을 모두 활용하는 애플리케이션을 개발하고 실행하기 위한 접근 방식이다"
– MS

"클라우드 네이티브 애플리케이션은 탄력적으로 결합된 소규모의 독립 서비스 컬렉션이다."
– Pivotal

"클라우드 네이티브 애플리케이션은 처음부터 클라우드 규모의 크기 조정 및 성능에 최적화되도록 빌드 된다.
이 솔루션은 마이크로 서비스 아키텍처를 기반으로 하며, 관리되는 서비스를 사용하고,
지속적인 업데이트를 활용해 안정성을 확보하고 출시 시간을 단축한다."
– RedHat

## 마이크로서비스 아키텍처
- 시스템 내부에서 어떤 서비스와 통신하는지 알 필요가 없는 외부의 API 클라이언트에게는 시스템의 복잡도를 숨긴다
- 게이트웨이는 클라이언트의 모든 요청을 다양한 API 종단점으로 동적으로 전달
- 동적이라는 말은 서비스 디스커버리의 목록에 기반한다는 뜻
- API게이트웨이는 시스템으로의 진입점이기 때문에 중요한 데이터를 추적하거나 요청 메트릭스를 수집하고 통계를 내기 좋은 장소가 될 수 있다
- 부가정보를 삽입하기 위해 요청 및 응답 헤더를 조작할 수도 있다

## 서비스 디스커버리의 필요성
- 컴퓨터 네트워크상의 디바이스가 제공하는 디바이스와 서비스를 자동으로 감지하는 서비스
- 모든 서비스는 시작 후 다른 서비스가 접근할 수 있는 하나의 중앙 장소에 자신을 등록


## 서비스 간 통신
- 시스템의 신뢰성을 보장하려면 각 서비스가 하나의 인스턴스로만 운영되게 하면 안된다
- 같은 서비스의 여러 인스턴스는 들어오는 요청에 대해 부하 분산을 적용해야 한다
- 부하 분산기는 대개 API 게이트웨이에 내장돼 있다
- 특별한 이유가 없다면 유입되는 트래픽을 50/50으로 모든 실행 중인 인스턴스에 분배하는 라운드 로빈 규칙을 적용한다

## 장애와 서킷 브레이커
- 대부분 장애의 발생 원인은 네트워크 또는 데이터베이스의 문제와 같이 관리의 범위를 벗어난다
- 하나의 요청이 많은 후속 호출에서 처리되는 마이크로서비스 기반의 시스템에서는 심각할 수 있다
- 가장 좋은 방법은 응답을 기다릴 때 네트워크 타임아웃을 활용하는 것이다
- 장시간 응답을 기다려서 스레드를 점유하는 대신 에러 응답을 보내는 것이 낫다
- 네트워크 타임아웃 문제에 대한 흥미로운 해결책은 서킷 브레이커 패턴일 수 있다
- 서킷 브레이커는 성공 및 실패 요청의 횟수를 센다
- 에러 비율이 가정된 임계치를 넘으면 차단이 발생하고 이후 즉시 실패된다

---

## Configuration File 사용자 정의
- .properties와 .yml 위치
    - 애플리케이션의 현재 디렉토리의 /config 하위 디렉토리
    - 애플리케이션의 현재 니렉토리
    - 클래스 경로/config 패키지
    - 클래스 경로 root

## Spring Boot Actuator
- 애플리케이션의 모니터링과 메트릭 수집이 중요하다
- Boot 2 버전 부터 CounterService 및 GaugeService는 MeterRegistry로 이동되었다
- 문서화와 메트릭, 상태 점검에 많은 부분이 마이크로서비스를 개발하고 유지보수하는 데 매우 중요하다
- 하지만, 스프링 부트는 이러한 것을 즉시 제공하므로 개발자가 거기에 너무 많은 시간을 할애하지 않아도 된다.